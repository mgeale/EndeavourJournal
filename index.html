<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>Capt. Cook Journal Onboard HMS Endeavour, 1768 to 1771</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/css/styles.css"></link>
  </head>
  <body>

  <div id="container"></div>

  <div id="info">
    <strong><a href="http://www.chromeexperiments.com/globe">WebGL Globe</a></strong>
    <span class="bull">&bull;</span>
    Created by <a href="https://twitter.com/mgeale">Matthew Geale</a>
    <span class="bull">&bull;</span>
    Data acquired from <a href="https://catalogue.nla.gov.au/Record/3525402">National Library of Australia</a>
    <span class="bull">&bull;</span>
    Starfield from <a href="http://labs.gmtaz.com/quake/">GMTAZ.com</a>
    <span class="bull">&bull;</span>
    Earth map from <a href="http://orbitingeden.com/orrery/soloearth.html">Orbiting Eden</a>
  </div>

  <div id="title">
    HMS Endeavour, 1768 to 1771
  </div>

  <a id="ce" href="http://www.chromeexperiments.com/globe">
    <span>This is a Chrome Experiment</span>
  </a>

  <script type="text/javascript" src="/js/third-party/Detector.js"></script>
  <script type="text/javascript" src="/js/third-party/three.min.js"></script>
  <script type="text/javascript" src="/js/globe.js"></script>
  <script type="text/javascript">

    if(!Detector.webgl){
      Detector.addGetWebGLMessage();
    } else {

      var container = document.getElementById('container');
      var globe = new DAT.Globe(container);

      console.log(globe);
      
      var xhr = new XMLHttpRequest();
      xhr.open('GET', '/endeavour-journal.json', true);
      xhr.onreadystatechange = function(e) {
        if (xhr.readyState === 4) {
          if (xhr.status === 200) {
            var data = JSON.parse(xhr.responseText);
            window.data = data;
            var coordinates = [];
            for (i=0;i<data.length;i++) {
              coordinates.push(data[i].coordinates.latitude, data[i].coordinates.longitude, 0.01);
            }
            globe.addData(coordinates, {format: 'magnitude', animated: true})
            globe.createPoints();
            globe.animate();
            // document.body.style.backgroundImage = 'none'; // remove loading
          }
        }
      };
      xhr.send(null);
    }

  </script>

  </body>

</html>
